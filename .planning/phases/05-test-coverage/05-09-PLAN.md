---
phase: 05-test-coverage
plan: 09
type: execute
wave: 6
depends_on: [05-04, 05-05]
files_modified:
  - test/components/phase/PhaseView.test.tsx
  - test/components/phase/GoalSection.test.tsx
  - test/components/phase/RequirementsList.test.tsx
  - test/components/phase/CriteriaList.test.tsx
  - test/components/todos/TodosView.test.tsx
  - test/components/todos/TodoItem.test.tsx
autonomous: true
must_haves:
  truths:
    - "Phase view tests pass (renders goal, requirements, success criteria)"
    - "Phase detail components tested (GoalSection, RequirementsList, CriteriaList)"
    - "TodosView tests pass (renders todo list)"
    - "TodoItem tests pass (renders checkbox, text, completion)"
  artifacts:
    - path: test/components/phase/PhaseView.test.tsx
      provides: "Phase view component tests"
      min_lines: 60
    - path: test/components/phase/GoalSection.test.tsx
      provides: "Goal section component tests"
      min_lines: 30
    - path: test/components/phase/RequirementsList.test.tsx
      provides: "Requirements list component tests"
      min_lines: 30
    - path: test/components/phase/CriteriaList.test.tsx
      provides: "Criteria list component tests"
      min_lines: 30
    - path: test/components/todos/TodosView.test.tsx
      provides: "Todos view component tests"
      min_lines: 50
    - path: test/components/todos/TodoItem.test.tsx
      provides: "Todo item component tests"
      min_lines: 30
  key_links:
    - from: test/components/phase/PhaseView.test.tsx
      to: src/components/phase/PhaseView.tsx
      via: "ink-testing-library render"
      pattern: "render\\(.*PhaseView"
---

<objective>
Add test coverage for phase view and todos view components with their subcomponents.

Purpose: Phase view shows detailed phase information (goal, requirements, success criteria). Todos view shows task list. These are core TUI views. Test that they render correctly with various states and handle keyboard interaction.

Output: Phase and todos views tested, detail rendering verified.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/phases/05-test-coverage/05-RESEARCH.md
@src/components/phase/PhaseView.tsx
@src/components/phase/GoalSection.tsx
@src/components/phase/RequirementsList.tsx
@src/components/phase/CriteriaList.tsx
@src/components/todos/TodosView.tsx
@src/components/todos/TodoItem.tsx
@.planning/phases/05-test-coverage/05-04-SUMMARY.md
@.planning/phases/05-test-coverage/05-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Add PhaseView component tests</name>
  <files>test/components/phase/PhaseView.test.tsx</files>
  <action>
    Create test/components/phase/PhaseView.test.tsx:

    Test cases:
    - Renders phase name and goal
    - Shows requirements list
    - Shows success criteria list
    - Handles detail level toggle (d key from 03.1-02)
    - Shows wave/task info at detail level 2+ (from 03.1-03 decision)
    - Handles missing data gracefully

    Use mock phase:
    ```typescript
    const mockPhase = {
      number: 1,
      name: 'Core TUI',
      goal: 'Build terminal UI',
      requirements: ['DISP-01', 'DISP-02'],
      successCriteria: ['User sees roadmap', 'User can navigate'],
    };
    ```

    Based on CLAUDE.md "Controlled PhaseView with lifted detailLevel state" decision.
  </action>
  <verify>bun test test/components/phase/PhaseView.test.tsx</verify>
  <done>PhaseView tests pass (goal, requirements, criteria, detail levels)</done>
</task>

<task type="auto">
  <name>Add phase detail component tests</name>
  <files>
    test/components/phase/GoalSection.test.tsx
    test/components/phase/RequirementsList.test.tsx
    test/components/phase/CriteriaList.test.tsx
  </files>
  <action>
    Create tests for phase subcomponents:

    **GoalSection.test.tsx:**
    - Renders goal text
    - Handles empty/missing goal

    **RequirementsList.test.tsx:**
    - Renders requirement IDs (DISP-01, NAV-01, etc.)
    - Shows comma-separated list
    - Handles empty requirements array

    **CriteriaList.test.tsx:**
    - Renders success criteria (numbered list)
    - Shows checkboxes for completed/uncompleted criteria
    - Handles empty criteria array
    - Wave/task info at detail level 2+ (from 03.1-03 decision)
  </action>
  <verify>bun test test/components/phase/</verify>
  <done>Phase detail component tests pass (GoalSection, RequirementsList, CriteriaList)</done>
</task>

<task type="auto">
  <name>Add TodosView component tests</name>
  <files>test/components/todos/TodosView.test.tsx</files>
  <action>
    Create test/components/todos/TodosView.test.tsx:

    Test cases:
    - Renders todo list
    - Shows completed todos with checkmark
    - Shows pending todos with empty checkbox
    - Handles empty todo list ("No todos" message)
    - Handles keyboard navigation (j/k, Enter to toggle)
    - Filters todos by completion state (all, pending, completed)

    Based on CLAUDE.md "TodosView (todo list)" feature.
    Use mock todos array:
    ```typescript
    const mockTodos = [
      { id: 1, text: 'First todo', completed: false },
      { id: 2, text: 'Second todo', completed: true },
    ];
    ```
  </action>
  <verify>bun test test/components/todos/TodosView.test.tsx</verify>
  <done>TodosView tests pass (rendering, completion states, navigation)</done>
</task>

<task type="auto">
  <name>Add TodoItem component tests</name>
  <files>test/components/todos/TodoItem.test.tsx</files>
  <action>
    Create test/components/todos/TodoItem.test.tsx:

    Test cases:
    - Renders todo text
    - Shows green checkmark for completed todos (from 03.1-03 decision)
    - Shows empty checkbox for pending todos
    - Handles toggle callback on Enter key
    - Handles toggle callback on click (if clickable)

    Based on CLAUDE.md "Checkbox styling: green checkmark for completed, empty for pending" decision.
  </action>
  <verify>bun test test/components/todos/TodoItem.test.tsx</verify>
  <done>TodoItem tests pass (rendering, checkbox, toggle callback)</done>
</task>

</tasks>

<verification>
Run `bun test test/components/phase/ test/components/todos/` - all phase and todos tests must pass.
Run `bun test --coverage` - verify phase and todos components have >= 75% coverage.
</verification>

<success_criteria>
- PhaseView tests cover goal, requirements, success criteria, detail levels
- Phase detail components tested (GoalSection, RequirementsList, CriteriaList)
- TodosView tests cover rendering, completion states, navigation
- TodoItem tests cover checkbox styling and toggle
- Phase and todos component coverage >= 75%
</success_criteria>

<output>
After completion, create `.planning/phases/05-test-coverage/05-09-SUMMARY.md`
</output>
