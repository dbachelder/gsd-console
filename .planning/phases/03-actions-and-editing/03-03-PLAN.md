---
phase: 03-actions-and-editing
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/todos/TodosView.tsx
  - src/components/todos/TodoItem.tsx
  - src/components/roadmap/RoadmapView.tsx
  - src/app.tsx
autonomous: true

must_haves:
  truths:
    - "User can press Space to toggle todo checkbox (shows stub toast)"
    - "User can select a command from palette and see stub execution toast"
    - "Phase reorder mode can be entered with r key (stub toast)"
  artifacts:
    - path: "src/components/todos/TodosView.tsx"
      provides: "Space key handler for todo toggle"
      contains: "Space"
    - path: "src/components/roadmap/RoadmapView.tsx"
      provides: "Reorder mode key handler"
      contains: "reorder"
  key_links:
    - from: "src/components/todos/TodosView.tsx"
      to: "useToast"
      via: "toast on toggle"
      pattern: "showToast.*toggle"
    - from: "src/app.tsx"
      to: "src/lib/commands.ts"
      via: "command execution"
      pattern: "command\\.action"
---

<objective>
Implement inline editing stubs for todos and phase reordering.

Purpose: Create the interaction patterns for inline editing that will be wired to real execution in Phase 4 (OpenCode Integration). Users can practice the workflow and understand what actions are available.
Output: Space toggles todo (stub), command palette executes commands (stub), `r` enters phase reorder mode (stub). All show toast feedback.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-actions-and-editing/03-CONTEXT.md

# Prior plan context
@.planning/phases/03-actions-and-editing/03-01-SUMMARY.md

# Existing code
@src/app.tsx
@src/components/todos/TodosView.tsx
@src/components/todos/TodoItem.tsx
@src/components/roadmap/RoadmapView.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Space key for todo toggle (stubbed)</name>
  <files>src/components/todos/TodosView.tsx, src/components/todos/TodoItem.tsx</files>
  <action>
1. Update `src/components/todos/TodosView.tsx`:
   - Accept showToast prop: `(message: string, type?: 'info' | 'success' | 'warning') => void`
   - In useInput handler, add case for Space key:
     - Get currently selected todo
     - Call showToast with "Todo toggle: [todo title] (will execute in Phase 4)", type 'info'
     - Do NOT actually modify any files - this is a stub

2. Update `src/components/todos/TodoItem.tsx`:
   - Optionally add visual feedback when Space is pressed (brief flash or inverse)
   - This is optional polish - prioritize the basic stub functionality first

3. Ensure Space key handler:
   - Only active when TodosView is active (use isActive prop)
   - Does not conflict with other key handlers
  </action>
  <verify>
    - `bun run typecheck` passes
    - Navigate to Todos tab, select a todo, press Space
    - Toast appears with toggle message
  </verify>
  <done>Space key shows stub toast for todo toggle</done>
</task>

<task type="auto">
  <name>Task 2: Wire command palette execution with toast feedback</name>
  <files>src/app.tsx, src/lib/commands.ts</files>
  <action>
1. Review `src/lib/commands.ts` from 03-01:
   - Ensure each command's action function receives showToast callback
   - Each action should call: `showToast("Command: [name] - will execute when connected to OpenCode", 'info')`

2. Update `src/app.tsx`:
   - When command is executed from palette:
     - Call command.action(showToast)
     - Close the palette
   - Ensure the flow is: Enter on palette -> execute action -> show toast -> close palette

3. Add commands that require additional input:
   - add-todo: After selection, could show "Enter todo text:" prompt (or just stub with toast)
   - For Phase 3, keep it simple: all commands just show stub toast
   - Phase 4 will add the actual input flows
  </action>
  <verify>
    - `bun run typecheck` passes
    - Press `:`, select add-todo, press Enter
    - Toast shows "Command: add-todo - will execute when connected to OpenCode"
    - Palette closes after execution
  </verify>
  <done>Command palette executes commands with stub toast feedback</done>
</task>

<task type="auto">
  <name>Task 3: Add phase reorder mode stub</name>
  <files>src/components/roadmap/RoadmapView.tsx, src/app.tsx</files>
  <action>
1. Update `src/components/roadmap/RoadmapView.tsx`:
   - Accept showToast prop
   - Add `r` key handler:
     - Call showToast("Phase reorder mode - will be implemented in Phase 4", 'info')
     - This is purely a stub - no actual reorder functionality yet
   - Only active when RoadmapView is active

2. Update `src/app.tsx`:
   - Pass showToast to RoadmapView component
   - Ensure r key doesn't conflict with other global handlers

3. Future reorder mode design (for documentation, not implementation):
   - `r` enters reorder mode (visual change: phases show numbers, footer shows "Move: j/k, Confirm: Enter, Cancel: Esc")
   - j/k moves selected phase up/down in list
   - Enter confirms new order (would call GSD command)
   - Esc cancels and restores original order
   - All of this is Phase 4 scope - for now just show the stub toast
  </action>
  <verify>
    - `bun run typecheck` passes
    - `bun run lint` passes
    - On Roadmap tab, press `r`
    - Toast shows reorder mode stub message
  </verify>
  <done>Phase reorder mode shows stub toast, ready for Phase 4 implementation</done>
</task>

</tasks>

<verification>
Run `bun run dev` in the gsd-tui directory:
1. Navigate to Todos tab, select a todo, press Space
   - Toast should appear with toggle message
2. Press `:`, type "add", select add-todo, press Enter
   - Toast should appear with command stub message
   - Palette should close
3. Navigate to Roadmap tab, press `r`
   - Toast should appear with reorder mode stub message
4. All toasts should auto-dismiss after 3 seconds
5. Normal navigation should work throughout
</verification>

<success_criteria>
- [x] Space on selected todo shows stub toast
- [x] Command palette execution shows stub toast
- [x] Palette closes after command execution
- [x] `r` on Roadmap tab shows reorder mode stub toast
- [x] All stubs clearly indicate "Phase 4" or "OpenCode" for future implementation
- [x] No actual file modifications occur (pure stubs)
- [x] `bun run typecheck` passes
- [x] `bun run lint` passes
</success_criteria>

<output>
After completion, create `.planning/phases/03-actions-and-editing/03-03-SUMMARY.md`
</output>
