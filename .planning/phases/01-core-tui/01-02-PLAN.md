---
phase: 01-core-tui
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/components/roadmap/RoadmapView.tsx
  - src/components/roadmap/PhaseRow.tsx
  - src/components/roadmap/ProgressBar.tsx
  - src/components/phase/PhaseView.tsx
  - src/components/phase/GoalSection.tsx
  - src/components/phase/CriteriaList.tsx
  - src/components/phase/RequirementsList.tsx
  - src/components/todos/TodosView.tsx
  - src/components/todos/TodoItem.tsx
  - src/components/layout/HelpOverlay.tsx
  - src/components/layout/TabLayout.tsx
  - src/hooks/useVimNav.ts
  - src/hooks/useTabNav.ts
  - src/app.tsx
autonomous: true

must_haves:
  truths:
    - "User sees all phases listed with status icons and progress bars"
    - "User can expand a phase to see goal, requirements, and success criteria"
    - "User sees todos list with completion status"
    - "User can navigate between Roadmap/Phase/Todos tabs with Tab and 1/2/3"
    - "User can scroll content with j/k, gg, G, Ctrl+d/u"
    - "User sees status icons per phase (complete, in-progress, blocked, has-plan, etc.)"
    - "Pressing ? shows help overlay with all keybindings"
  artifacts:
    - path: "src/components/roadmap/RoadmapView.tsx"
      provides: "Roadmap tab showing all phases"
      min_lines: 40
    - path: "src/components/phase/PhaseView.tsx"
      provides: "Phase detail view with goal and criteria"
      min_lines: 50
    - path: "src/components/todos/TodosView.tsx"
      provides: "Todos list view"
      min_lines: 30
    - path: "src/hooks/useVimNav.ts"
      provides: "Vim keybinding handler"
      exports: ["useVimNav"]
    - path: "src/components/layout/HelpOverlay.tsx"
      provides: "Full-screen help overlay"
      min_lines: 30
  key_links:
    - from: "src/components/layout/TabLayout.tsx"
      to: "src/components/roadmap/RoadmapView.tsx"
      via: "conditional render based on active tab"
      pattern: "activeTab.*roadmap"
    - from: "src/components/roadmap/RoadmapView.tsx"
      to: "src/hooks/useVimNav.ts"
      via: "hook for scroll navigation"
      pattern: "useVimNav"
    - from: "src/app.tsx"
      to: "src/components/layout/HelpOverlay.tsx"
      via: "conditional render on help state"
      pattern: "showHelp.*HelpOverlay"
---

<objective>
Build the three main views (Roadmap, Phase, Todos) with full keyboard navigation including Vim keybindings.

Purpose: Complete the Phase 1 requirements by implementing all display functionality (DISP-01 through DISP-04) and navigation (NAV-01 through NAV-03).

Output: A fully functional read-only TUI showing GSD project status with keyboard-driven navigation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/01-core-tui/01-CONTEXT.md
@.planning/phases/01-core-tui/01-RESEARCH.md
@.planning/phases/01-core-tui/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Vim navigation and tab navigation hooks</name>
  <files>
    - src/hooks/useVimNav.ts
    - src/hooks/useTabNav.ts
  </files>
  <action>
Create reusable hooks for keyboard navigation.

1. Create src/hooks/useVimNav.ts:
   - Accept config: { itemCount: number, pageSize: number, isActive: boolean }
   - Manage state: selectedIndex, scrollOffset
   - Track last key press for double-key detection (gg):
     ```typescript
     const [lastKey, setLastKey] = useState({ key: '', time: 0 });
     ```
   - Use ink's useInput hook with isActive option (only listen when active)
   - Handle keys:
     - j, down arrow: Move selection down (clamp to itemCount - 1)
     - k, up arrow: Move selection up (clamp to 0)
     - h, left arrow: Collapse/go back (expose via callback)
     - l, right arrow, Enter: Expand/select (expose via callback)
     - gg (two g presses within 300ms): Jump to first item
     - G (shift+g): Jump to last item
     - Ctrl+d: Page down (move by pageSize, scroll if needed)
     - Ctrl+u: Page up (move by pageSize, scroll if needed)
     - Page Down: Same as Ctrl+d
     - Page Up: Same as Ctrl+u
   - Return: { selectedIndex, scrollOffset, setSelectedIndex, setScrollOffset }
   - Compute visible range based on scrollOffset and pageSize

2. Create src/hooks/useTabNav.ts:
   - Accept config: { tabs: string[], initialTab?: string, isActive: boolean }
   - Manage activeTab state
   - Use useInput with isActive option
   - Handle keys:
     - Tab: Cycle to next tab
     - Shift+Tab: Cycle to previous tab
     - 1, 2, 3: Jump directly to tab by index
   - Return: { activeTab, setActiveTab }
   - Use useFocusManager to update focus when tab changes (optional enhancement)

Both hooks should be conditional based on isActive to prevent key conflicts when help overlay is shown or during other modal states.
  </action>
  <verify>
    - Hooks compile without TypeScript errors
    - Can be imported and used in a test component
    - Double-g detection works (gg jumps to top, single g does nothing)
  </verify>
  <done>useVimNav handles j/k/gg/G/Ctrl+d/u navigation. useTabNav handles Tab/1/2/3 tab switching. Both respect isActive flag.</done>
</task>

<task type="auto">
  <name>Task 2: Build Roadmap and Phase views with visual indicators</name>
  <files>
    - src/components/roadmap/RoadmapView.tsx
    - src/components/roadmap/PhaseRow.tsx
    - src/components/roadmap/ProgressBar.tsx
    - src/components/phase/PhaseView.tsx
    - src/components/phase/GoalSection.tsx
    - src/components/phase/CriteriaList.tsx
    - src/components/phase/RequirementsList.tsx
    - src/components/layout/TabLayout.tsx
  </files>
  <action>
Create the Roadmap and Phase detail views.

1. Create src/components/roadmap/ProgressBar.tsx:
   - Accept props: { percent: number, width?: number }
   - Render a visual progress bar using box-drawing characters:
     ```
     [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] 52%
     ```
   - Use green for filled portion, dim for empty
   - Make width configurable (default 20 chars)

2. Create src/components/roadmap/PhaseRow.tsx:
   - Accept props: { phase: Phase, isSelected: boolean, isExpanded: boolean }
   - Render one line per phase:
     ```
     ‚ñ∂ [‚úì] Phase 1: Core TUI                    [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] 2/2 plans
         üìã üìù üî¨
     ```
   - Show chevron (‚ñ∂/‚ñº) for expand/collapse state
   - Status icon based on phase.status (use icons from lib/icons.ts)
   - Phase name with number
   - Mini progress bar showing plans complete
   - Second line (when expanded or always visible): indicator icons
   - Highlight background when isSelected

3. Create src/components/roadmap/RoadmapView.tsx:
   - Accept props: { phases: Phase[], isActive: boolean }
   - Use useVimNav hook for navigation
   - Render list of PhaseRow components
   - Track expanded phases (Set of phase numbers)
   - l/Enter key expands, h key collapses
   - Enter on expanded phase could navigate to Phase tab (or just expand/collapse)
   - Show overall project progress at top
   - Implement toggleable detail level (e.g., d key toggles showing indicator icons)
   - Handle scroll offset for long phase lists

4. Create src/components/phase/GoalSection.tsx:
   - Accept props: { goal: string }
   - Render phase goal with nice formatting
   - Add subtle header label "Goal:"

5. Create src/components/phase/CriteriaList.tsx:
   - Accept props: { criteria: string[], label?: string }
   - Render numbered list of success criteria
   - Each criterion as a checkbox-style item (unchecked by default in Phase 1)

6. Create src/components/phase/RequirementsList.tsx:
   - Accept props: { requirements: string[] }
   - Render requirement IDs in a compact format
   - Could be horizontal list or grid

7. Create src/components/phase/PhaseView.tsx:
   - Accept props: { phase: Phase, allPhases: Phase[], isActive: boolean }
   - Use useVimNav for scrolling within the view
   - Display phase header with name and status
   - Render GoalSection, CriteriaList, RequirementsList
   - Show phase indicators (has context, has plan, etc.)
   - Add keybinding to switch to prev/next phase ([ and ] keys, or n/p)
   - Implement toggleable detail levels (d key):
     - Level 1: Goal + success criteria + plans
     - Level 2: Add requirements, dependencies
     - Level 3: Add context notes if available
   - Default to level 1

8. Update src/components/layout/TabLayout.tsx:
   - Replace placeholder content with actual views
   - Import and render RoadmapView, PhaseView, TodosView
   - Pass isActive prop based on activeTab (only active view handles keys)
   - In --only mode, render just that one view without tab bar
  </action>
  <verify>
    - Roadmap view shows all phases with correct status icons
    - Selecting a phase (j/k) highlights it
    - Expanding a phase (l/Enter) shows indicator icons
    - Phase view shows goal, success criteria, requirements
    - [ and ] keys switch between phases
    - d key toggles detail level (visible change in content)
  </verify>
  <done>RoadmapView shows phase list with status indicators and progress. PhaseView shows goal, criteria, requirements with toggleable detail. Both support Vim navigation.</done>
</task>

<task type="auto">
  <name>Task 3: Build Todos view and Help overlay</name>
  <files>
    - src/components/todos/TodosView.tsx
    - src/components/todos/TodoItem.tsx
    - src/components/layout/HelpOverlay.tsx
    - src/components/layout/Footer.tsx
    - src/app.tsx
  </files>
  <action>
Create the Todos view and help system.

1. Create src/components/todos/TodoItem.tsx:
   - Accept props: { todo: Todo, isSelected: boolean }
   - Render single todo with checkbox:
     ```
     [ ] Implement file watching for real-time updates
     [x] Set up project structure
     ```
   - Show optional metadata (source file, related phase) when detail mode is on
   - Highlight when selected

2. Create src/components/todos/TodosView.tsx:
   - Accept props: { todos: Todo[], isActive: boolean }
   - Use useVimNav for navigation
   - Render list of TodoItem components
   - Group by status: incomplete first, then completed
   - Show count in header: "Todos (3 pending, 5 done)"
   - Implement toggleable detail (d key):
     - Level 1: Just todo text
     - Level 2: Add source file, related phase
   - Support filtering (f key to toggle showing completed)
   - Scroll handling for long lists

3. Create src/components/layout/HelpOverlay.tsx:
   - Full-screen overlay (Box with absolute position or replace main content)
   - Show all keybindings organized by category:
     ```
     GSD Status TUI - Keyboard Shortcuts

     Navigation
       j/‚Üì        Move down
       k/‚Üë        Move up
       h/‚Üê        Collapse/back
       l/‚Üí/Enter  Expand/select
       gg         Jump to top
       G          Jump to bottom
       Ctrl+d     Page down
       Ctrl+u     Page up

     Tabs
       Tab        Next tab
       Shift+Tab  Previous tab
       1/2/3      Jump to tab

     Views
       d          Toggle detail level
       f          Filter (in Todos)
       [/]        Prev/next phase

     General
       ?          Toggle this help
       q          Quit

     Press any key to close
     ```
   - Dismiss on any key press
   - Use Box with borderStyle for visual distinction

4. Update src/components/layout/Footer.tsx:
   - Show context-sensitive hints based on current view
   - Roadmap: "j/k: select | l: expand | d: details | ?: help | q: quit"
   - Phase: "j/k: scroll | [/]: switch phase | d: details | ?: help | q: quit"
   - Todos: "j/k: select | f: filter | d: details | ?: help | q: quit"
   - Accept activeTab prop to determine which hints to show

5. Update src/app.tsx:
   - Add showHelp state (boolean)
   - Add useInput handler for ? key to toggle help
   - Add useInput handler for q key to exit (using useApp().exit())
   - Conditionally render HelpOverlay when showHelp is true
   - Pass showHelp state to child components so they can disable input
   - Pass isActive={!showHelp} to TabLayout so views don't handle keys during help
  </action>
  <verify>
    - Todos view shows all todos with checkbox indicators
    - j/k navigation selects different todos
    - f key toggles completed todos visibility
    - ? key shows help overlay with all keybindings
    - Any key dismisses help overlay
    - q key exits the app cleanly
    - Footer shows relevant hints for current view
  </verify>
  <done>TodosView shows todos with filtering and navigation. HelpOverlay documents all keybindings. Footer shows context-sensitive hints. ? and q keys work globally.</done>
</task>

</tasks>

<verification>
After completing all tasks, verify all Phase 1 requirements:

**Display requirements:**
- [DISP-01] Roadmap overview with phases and progress: `bun start` shows phase list with progress bars
- [DISP-02] Phase details: Select phase, press l or go to Phase tab, see goal/criteria
- [DISP-03] Todos list: Todos tab shows pending and completed todos
- [DISP-04] Visual indicators: Each phase shows status icon and indicator icons (plan, context, etc.)

**Navigation requirements:**
- [NAV-01] Tab/arrow navigation: Tab key cycles tabs, arrow keys select items
- [NAV-02] Vim keybindings: j/k move, gg/G jump, Ctrl+d/u page
- [NAV-03] Scroll content: Long lists scroll when navigating past visible area

**Technical requirements:**
- [TECH-01] Built with Ink: Check package.json, all components use Ink
- [TECH-02] Parses planning docs: Data loads from .planning/ files
- [TECH-03] Works in split pane: Run alongside other terminal content

**Additional from CONTEXT.md:**
- `--only roadmap|phase|todos` flag works for single-view mode
- Detail toggle (d key) changes information density
- Number keys (1/2/3) jump directly to tabs
- Help overlay (?) shows all keybindings
</verification>

<success_criteria>
- All three views (Roadmap, Phase, Todos) render with real data
- Vim navigation works in all views (j/k/gg/G/Ctrl+d/u)
- Tab/number key navigation switches between views
- Status indicators show correct icons per phase status
- Detail level toggle changes displayed information
- Help overlay documents all keybindings
- App exits cleanly on q
- Single-view mode (--only) works
- Footer shows context-sensitive hints
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-tui/01-02-SUMMARY.md`
</output>
